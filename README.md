# Проект Фудграм 

«Фудграм» — сайт, на котором пользователи будут публиковать свои рецепты, добавлять чужие рецепты в избранное и подписываться на публикации других авторов. Зарегистрированным пользователям также будет доступен сервис «Список покупок». Он позволит создавать список продуктов, которые нужно купить для приготовления выбранных блюд.

Все сервисы и страницы проекта должны быть доступны для пользователей в соответствии с их правами.

Для авторизованных пользователей:
- Доступна главная страница.
- Доступна страница другого пользователя.
- Доступна страница отдельного рецепта.
- Доступна страница «Мои подписки»:
  - можно подписаться и отписаться на странице рецепта;
  - можно подписаться и отписаться на странице автора;
  - при подписке рецепты автора добавляются на страницу «Мои подписки» и удаляются оттуда при отказе от подписки.
- Доступна страница «Избранное»:
  - на странице рецепта есть возможность добавить рецепт в список избранного и удалить его оттуда;
  - на любой странице со списком рецептов есть возможность добавить рецепт в список избранного и удалить его оттуда.
- Доступна страница «Список покупок»:
  - на странице рецепта есть возможность добавить рецепт в список покупок и удалить его оттуда;
  - на любой странице со списком рецептов есть возможность добавить рецепт в список покупок и удалить его оттуда;
  - есть возможность выгрузить файл с перечнем и количеством необходимых ингредиентов для рецептов из «Списка покупок»;
  - ингредиенты в выгружаемом списке не повторяются, корректно подсчитывается общее количество для каждого ингредиента.
- Доступна страница «Создать рецепт»:
  - есть возможность опубликовать свой рецепт;
  - есть возможность отредактировать и сохранить изменения в своём рецепте;
  - есть возможность удалить свой рецепт.
- Доступна возможность изменить пароль.
- Доступна возможность изменить/удалить изображение профиля.
- Доступна возможность выйти из системы.

Для неавторизованных пользователей:

- Доступна главная страница.
- Доступна страница отдельного рецепта.
- Доступна страница любого пользователя.
- Доступна и работает форма входа.
- Доступна и работает форма регистрации.

Администратор и админ-зона:

- Все модели выведены в админ-зону.
- Для модели пользователей доступен поиск по имени и адресу электронной почты.
- Для модели рецептов включен поиск по названию, автору и фильтрация по тегам.
- На админ-странице рецепта отображается общее число добавлений этого рецепта в избранное.
- Для модели ингредиентов работает поиск по названию.

## Описание
Проект состоит из следующих страниц: 
- главная,
- страница входа,
- страница регистрации,
- страница рецепта,
- страница пользователя,
- страница подписок,
- избранное,
- список покупок,
- создание и редактирование рецепта,
- страница смены пароля,
- статические страницы «О проекте» и
- «Технологии».

### Главная
Содержимое главной — список первых шести рецептов, отсортированных по дате публикации «от новых к старым». На этой странице подразумевается постраничная пагинация. Остальные рецепты должны быть доступны на следующих страницах.

### Страница регистрации
В проекте доступна система регистрации и аутентификации пользователей. 

Обязательные поля для пользователя при регистрации:
- имя,
- фамилия,
- имя пользователя (никнейм),
- адрес электронной почты,
пароль.

### Страница входа
После регистрации пользователь переадресовывается на страницу входа.

### Статические страницы
Проект предусматривает как минимум две статические страницы: «О проекте» и «Технологии».

### Страница рецепта
Здесь — полное описание рецепта. Залогиненные пользователи могут добавить рецепт в избранное и список покупок, а также подписаться на автора рецепта.

Для каждого рецепта можно получить прямую короткую ссылку, нажав на соответствующую иконку справа от названия рецепта. Эта ссылка не меняется после редактирования рецепта.

В большинстве браузеров, например на основе Chromium, ссылка автоматически скопируется в буфер обмена, а в Safari — выведется на экран в правом верхнем углу, откуда её можно скопировать в буфер обмена. Такое поведение реализовано в SPA-приложении.

### Страница пользователя
На странице — имя пользователя, все рецепты, опубликованные пользователем, и кнопка, чтобы подписаться или отписаться от него.

### Страница подписок
Только владелец аккаунта может просмотреть свою страницу подписок. Ссылка на неё находится в выпадающем меню в правом верхнем углу.

Подписаться на публикации могут только залогиненные пользователи.

Сценарий поведения пользователя:
1. Пользователь переходит на страницу другого пользователя или на страницу рецепта и подписывается на публикации автора кликом по кнопке Подписаться на автора.
2. Пользователь переходит на страницу Мои подписки и просматривает список рецептов, опубликованных теми авторами, на которых он подписался. Записи сортируются по дате публикации — от новых к старым.
3. При необходимости пользователь может отказаться от подписки на автора. Тогда ему нужно перейти на страницу автора, его рецепта или на страницу своих подписок и нажать кнопку Отписаться.

### Избранное
Добавлять рецепты в избранное может только залогиненный пользователь.

Если незалогиненный пользователь попробует добавить рецепт в избранное, подписки или покупки, то приложение попросит его зарегистрироваться или войти в свой аккаунт.

Добавить рецепт в избранное можно с главной страницы и со страницы самого рецепта, нажав на соответствующую иконку.

Сам список избранного может просмотреть только его владелец.

Сценарий поведения пользователя:
1. Пользователь отмечает один или несколько рецептов кликом по кнопке Добавить в избранное.
2. Пользователь переходит на страницу Избранное и просматривает свой список избранных рецептов.
3. При необходимости пользователь может удалить рецепт из избранного.

### Список покупок
Работать со списком покупок могут только залогиненные пользователи. Доступ к собственному списку покупок есть только у владельца аккаунта.

Сценарий поведения пользователя:
1. Пользователь отмечает один или несколько рецептов кликом по кнопке Добавить в покупки. Сделать это можно с главной страницы или со страницы рецепта.
2. Пользователь переходит на страницу Список покупок, там доступны все добавленные в список рецепты. Пользователь нажимает кнопку Скачать список и получает файл с перечнем и количеством необходимых ингредиентов для всех рецептов, сохранённых на странице Список покупок.
3. При необходимости пользователь может удалить рецепт из списка покупок.

Пользователь может скачать свой список покупок в формате .txt, .pdf или любом другом, который разработчик выбрал при реализации программы.
Ингредиенты в скачанном списке не дублируются. Если в двух рецептах есть сахар (в одном рецепте 5 г, в другом — 10 г), в списке должен быть один пункт: Сахар — 15 г. То есть ингредиенты в списке покупок суммируются.

Сам список выглядит примерно так:
- Фарш (баранина и говядина) (г) — 600
- Сыр плавленый (г) — 200
- Лук репчатый (г) — 50
- Картофель (г) — 1000
- Молоко (мл) — 250
- Яйцо куриное (шт.) — 5
- Соевый соус (ст. л.) — 8
- Сахар (г) — 230
- Растительное масло рафинированное (ст. л.) — 2
- Соль (по вкусу) — 4
- Перец чёрный (щепотка) — 3

### Создание и редактирование рецепта
Эта страница доступна только для залогиненных пользователей. Все поля на ней обязательны для заполнения. 

Сценарий поведения пользователя:
1. Пользователь переходит на страницу добавления рецепта, нажав на кнопку Создать рецепт в шапке сайта.
2. Пользователь заполняет все обязательные поля.
3. Пользователь нажимает кнопку Создать рецепт.

Также пользователь может отредактировать любой рецепт, который он создал.

### Страница изменения пароля
Доступ к этой странице есть только у залогиненных пользователей, через кнопку Сменить пароль в выпадающем меню в правом верхнем углу страницы.

### Фильтрация по тегам
Тег (от англ. tag, «метка», «бирка», «ярлык») — метка, которая классифицирует данные и помогает облегчить процесс поиска нужной информации в веб-приложении.

При добавлении рецепта обязательно указывается один или несколько тегов. Новые теги может добавить только администратор сайта.

На страницах с рецептами при нажатии на название тега выводится список рецептов, отмеченных этим тегом. Фильтрация может проводиться по нескольким тегам в комбинации «или»: если выбрано несколько тегов, в результате должны быть показаны рецепты, которые отмечены хотя бы одним из этих тегов. 

При фильтрации на странице пользователя фильтруются только рецепты выбранного пользователя. Такой же принцип должен соблюдаться при фильтрации списка избранного.

### Смена аватара
После регистрации новый пользователь получает изображение профиля по умолчанию.

При клике на аватар у пользователя в шапке сайта появляется возможность поменять его или удалить.

### Разграничение прав
В проекте описаны разные уровни доступа пользователей:
- гость (анонимный пользователь),
- аутентифицированный (залогиненный) пользователь,
- администратор.

[Ссылка на установку](#установка)

## Исполнители
- [Максим](https://github.com/kasyak999)

## Необходимые условия

- Версия Python: 3.9
- ОС: Windows, Linux, MacOS
- Менеджер пакетов: pip
- БД: PostgreSQL

## Установка

1. Скопировать файл
`docker-compose.production.yml` на сервер
2. Создать файл `.env'
    ``` bash
    POSTGRES_USER=django_user
    POSTGRES_PASSWORD=password
    POSTGRES_DB=django
    DB_HOST=db
    DB_PORT=5432
    SECRET_KEY=ключ
    ```
5.  Запустить
    ```bash
    sudo docker compose -f docker-compose.production.yml up
    ```

[Ссылка на описание](#описание)

### Документация API
находясь в папке infra, выполните в терминале команду 
```bash
docker compose up
```
По адресу http://localhost изучите фронтенд веб-приложения, а по адресу http://localhost/api/docs/ — спецификацию API.

## Тестирование
Код соответствует PEP 8.
